from flask import Flask, render_template
import subprocess
import time

app = Flask(__name__)

def get_cpu_temperature():
    try:
        # Suorita komento "vcgencmd measure_temp" ja hanki lämpötilatieto
        result = subprocess.check_output(["vcgencmd", "measure_temp"]).decode("utf-8")
        
        # Irrota lämpötila merkkijonosta
        temperature = float(result.replace("temp=", "").replace("'C\n", ""))
        
        return temperature
    except Exception as e:
        print(f"Virhe: {e}")
        return None

@app.route('/') ### http://127.0.0.1:8080/
def index():
    return 'Hello world yass'



@app.route('/temperature') ### http://127.0.0.1:8080/temperature
def temperature():
    cpu_temperature = get_cpu_temperature()
    if cpu_temperature is not None:
        return f'Prosessin lämpötila: {cpu_temperature}°C'
    else:
        return 'Lämpötilan lukeminen epäonnistui'

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=8080)
